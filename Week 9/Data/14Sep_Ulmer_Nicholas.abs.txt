Energy managers are faced with the challenge of upgrading their installation microgrids in a tight fiscal environment, while meeting the challenges of incorporating higher percentages of renewable energy sources and providing better energy assurance during commercial grid failures. Incorporating renewable sources of energy into a microgrid is challenging due to the intermittent nature of supply. Using historical solar data and simulated forecasts for wind data, we formulate and exercise a capital planning optimization model designed to choose the best subset of existing and potential energy sources to maximize microgrid islanding time. Islanding time is defined as the amount of time demands can be met without connection to the commercial power grid, and it is one measure of an installationâ€™s power resiliency. Using sensitivity analysis, we show quantitatively how increases in the capital planning budget has a direct positive impact on islanding time. However, the model also identifies areas where large increases in budget yield proportionally smaller returns in islanding time. Additionally, energy storage can provide increases in islanding time, but there are diminishing returns as the storage capacity is increased. Finally, we quantitatively show that increasing reliance on renewable power decreases sensitivity to changes in the price of fuel.